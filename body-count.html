<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>BODY COUNT: MOSHPIT</title>
    <!-- NIEUWE FONTS: LEESBAAR MAAR HARD -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Black+Ops+One&family=Metal+Mania&display=swap" rel="stylesheet">
    
    <style>
        /* * STIJL: HARDCORE / TRASH / METAL
         * Geen genade. Hoog contrast. Rauw.
         */
        :root {
            --bg-color: #0a0a0a;
            --text-color: #eee;
            --accent-yellow: #fce94f; 
            --blood-red: #8a0303;
            --bright-red: #ff0000;
            
            /* FONTS - AANGEPAST VOOR LEESBAARHEID */
            --font-title: 'Metal Mania', cursive; /* Metal vibe, maar leesbaar */
            --font-ui: 'Black Ops One', system-ui; /* Stencil voor cijfers */
        }

        body {
            margin: 0;
            overflow: hidden;
            background-color: var(--bg-color);
            background-image: 
                radial-gradient(circle at 50% 50%, #1a1a1a 0%, #000 100%);
            font-family: var(--font-ui);
            color: var(--text-color);
            touch-action: none;
            user-select: none;
            -webkit-user-select: none;
            cursor: crosshair; 
        }

        /* GRUNGE OVERLAY */
        body::after {
            content: "";
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIj48ZmlsdGVyIGlkPSJmIj48ZmVUdXJidWxlbmNlIHR5cGU9ImZyYWN0YWxOb2lzZSIgYmFzZUZyZXF1ZW5jeT0iMC42NSIgbnVtT2N0YXZlcz0iMyIgc3RpdGNoVGlsZXM9InN0aXRjaCIvPjwvZmlsdGVyPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbHRlcj0idXJsKCNmKSIgb3BhY2l0eT0iMC4wNSIvPjwvc3ZnPg==');
            pointer-events: none;
            opacity: 0.3;
            z-index: 2;
        }

        canvas {
            display: block;
            width: 100vw;
            height: 100vh;
        }

        /* UI Overlay */
        .hud {
            position: absolute;
            top: 20px;
            left: 0;
            width: 100%;
            pointer-events: none;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            z-index: 5;
        }

        .score {
            font-size: 5rem;
            color: #fff;
            margin: 0;
            text-shadow: 0 0 10px var(--bright-red);
            font-family: var(--font-ui);
            letter-spacing: 2px;
        }

        .label {
            font-size: 2.5rem; /* Iets groter */
            color: var(--blood-red);
            font-family: var(--font-title);
            text-transform: uppercase;
            letter-spacing: 3px;
            text-shadow: 2px 2px 0 #000;
        }

        /* Menu Schermen */
        .screen {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background: rgba(5, 5, 5, 0.95);
            z-index: 10;
            transition: opacity 0.2s;
        }

        .hidden {
            opacity: 0;
            pointer-events: none;
        }

        h1 {
            font-family: var(--font-title);
            font-size: 7rem; /* Flinke header */
            margin: 0;
            color: #fff;
            text-transform: uppercase;
            text-shadow: 0 0 20px var(--blood-red);
            text-align: center;
            line-height: 0.9;
            letter-spacing: 2px;
        }

        p {
            font-size: 1.5rem;
            max-width: 90%;
            text-align: center;
            margin-bottom: 50px;
            margin-top: 20px;
            font-family: var(--font-ui);
            color: #aaa;
            text-transform: uppercase;
            letter-spacing: 1px;
            line-height: 1.4;
        }

        /* BRUTALE KNOPPEN */
        button {
            background: transparent;
            border: 3px solid #fff;
            padding: 15px 40px;
            font-family: var(--font-ui);
            font-size: 1.8rem;
            text-transform: uppercase;
            color: #fff;
            cursor: pointer;
            transition: all 0.1s;
            position: relative;
            z-index: 20;
            letter-spacing: 2px;
            overflow: hidden;
        }

        button::before {
            content: '';
            position: absolute;
            top: 0; left: 0; width: 0%; height: 100%;
            background: var(--blood-red);
            z-index: -1;
            transition: width 0.2s cubic-bezier(0.25, 1, 0.5, 1);
        }

        button:hover::before {
            width: 100%;
        }

        button:hover {
            border-color: var(--blood-red);
            text-shadow: 0 0 5px #000;
            transform: scale(1.05);
        }

        button:active {
            transform: scale(0.95);
        }

        /* Flash effect bij hit */
        .flash {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: var(--bright-red);
            opacity: 0;
            pointer-events: none;
            z-index: 6;
            transition: opacity 0.05s;
            mix-blend-mode: overlay;
        }

        .shaking {
            animation: aggressive-shake 0.4s cubic-bezier(.36,.07,.19,.97) both;
        }

        @keyframes aggressive-shake {
            10%, 90% { transform: translate3d(-3px, 2px, 0) rotate(1deg); }
            20%, 80% { transform: translate3d(4px, -2px, 0) rotate(-1deg); }
            30%, 50%, 70% { transform: translate3d(-6px, -4px, 0); }
            40%, 60% { transform: translate3d(6px, 4px, 0); }
        }
    </style>
</head>
<body>

    <div class="hud">
        <div class="label">Body Count</div>
        <div class="score" id="scoreEl">0</div>
    </div>

    <div id="flashOverlay" class="flash"></div>

    <div id="startScreen" class="screen">
        <h1>TOTAL<br>CHAOS</h1>
        <p>Jij tegen de rest.<br>Tik om te slopen.<br>Niet knipperen.</p>
        <button id="startBtn">START RIOT</button>
    </div>

    <div id="gameOverScreen" class="screen hidden">
        <h1 style="color: var(--blood-red); text-shadow: none;">KAPOT</h1>
        <p id="deathMsg">...</p>
        <p class="score" id="finalScore" style="font-size: 3rem; color: #fff;">0</p>
        <button id="retryBtn">REVENGE</button>
    </div>

    <canvas id="gameCanvas"></canvas>

    <script>
        /**
         * LOGICA: BRUTAAL EN SNEL
         */
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const scoreEl = document.getElementById('scoreEl');
        const finalScoreEl = document.getElementById('finalScore');
        const deathMsg = document.getElementById('deathMsg');
        const flashOverlay = document.getElementById('flashOverlay');
        const startScreen = document.getElementById('startScreen');
        const gameOverScreen = document.getElementById('gameOverScreen');

        let width, height, centerX, centerY;
        let animationId;
        let lastTime = 0;
        let score = 0;
        let gameActive = false;
        
        // Difficulty settings
        let spawnRate = 1000; 
        let lastSpawn = 0;
        let difficultyMultiplier = 1;

        // Entities
        let player = { radius: 30, health: 100 };
        let enemies = [];
        let particles = [];
        let bloodSplats = []; 
        let tracers = []; 
        let muzzleFlashes = []; // NIEUW: Voor directionele flashes

        // DE BELEDIGINGEN DATABASE
        const insults = [
            "JE OMA MOSHT HARDER DAN JIJ.",
            "GA MAAR WEER SIMS SPELEN.",
            "IS DAT ALLES? TRIEST.",
            "JE VINGERS ZIJN SPAGHETTI.",
            "KEIHARDE FAALHAAS.",
            "BEN JE NU AL MOE?",
            "MIJN GOUDVIS HEEFT MEER RHYTHM.",
            "HAHAHAHA. NEE.",
            "GEWOON STOPPEN. NU.",
            "WAT EEN DRAMA DIT."
        ];

        function resize() {
            width = window.innerWidth;
            height = window.innerHeight;
            canvas.width = width;
            canvas.height = height;
            centerX = width / 2;
            centerY = height / 2;
        }
        window.addEventListener('resize', resize);
        resize();

        class Enemy {
            constructor() {
                const angle = Math.random() * Math.PI * 2;
                const distance = Math.max(width, height) * 0.6 + 50; 
                this.x = centerX + Math.cos(angle) * distance;
                this.y = centerY + Math.sin(angle) * distance;
                
                this.radius = 15 + Math.random() * 20;
                let baseSpeed = 1.5 + Math.random(); 
                this.speed = baseSpeed * difficultyMultiplier; 
                
                const angleToCenter = Math.atan2(centerY - this.y, centerX - this.x);
                this.vx = Math.cos(angleToCenter) * this.speed;
                this.vy = Math.sin(angleToCenter) * this.speed;
                
                this.color = Math.random() > 0.8 ? '#8a0303' : '#333'; 
                this.isElite = this.color === '#8a0303';
            }

            update() {
                this.x += this.vx;
                this.y += this.vy;

                const dist = Math.hypot(this.x - centerX, this.y - centerY);
                if (dist - this.radius - player.radius < 0) {
                    playerHit(this.isElite ? 25 : 15); 
                    return true; 
                }
                return false;
            }

            draw() {
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
                ctx.fillStyle = this.color;
                ctx.fill();
                ctx.strokeStyle = '#111';
                ctx.lineWidth = 2;
                ctx.stroke();

                ctx.beginPath();
                const r = this.radius * 0.5;
                ctx.moveTo(this.x - r, this.y - r);
                ctx.lineTo(this.x + r, this.y + r);
                ctx.moveTo(this.x + r, this.y - r);
                ctx.lineTo(this.x - r, this.y + r);
                ctx.strokeStyle = '#555'; 
                ctx.lineWidth = 2;
                ctx.stroke();
            }
        }

        // De kogelbaan / Tracer
        class Tracer {
            constructor(tx, ty) {
                this.tx = tx; 
                this.ty = ty; 
                this.life = 1.0; 
                this.decay = 0.15; 
                
                this.sx = centerX + (Math.random() - 0.5) * 10;
                this.sy = centerY + (Math.random() - 0.5) * 10;
            }

            update() {
                this.life -= this.decay;
            }

            draw() {
                if (this.life <= 0) return;
                ctx.beginPath();
                ctx.moveTo(this.sx, this.sy);
                ctx.lineTo(this.tx, this.ty);
                
                ctx.strokeStyle = `rgba(255, 255, 200, ${this.life})`; 
                ctx.lineWidth = 3 * this.life;
                ctx.stroke();
                
                ctx.beginPath();
                ctx.arc(this.tx, this.ty, 4 * this.life, 0, Math.PI * 2);
                ctx.fillStyle = `rgba(255, 255, 255, ${this.life})`;
                ctx.fill();
            }
        }

        // NIEUW: Directional Muzzle Flash
        class MuzzleFlash {
            constructor(tx, ty) {
                this.angle = Math.atan2(ty - centerY, tx - centerX);
                this.life = 1.0;
                this.decay = 0.2; // Snel weg
            }
            
            update() {
                this.life -= this.decay;
            }

            draw() {
                if (this.life <= 0) return;
                
                ctx.save();
                ctx.translate(centerX, centerY);
                ctx.rotate(this.angle);
                
                // Teken een kegel / waaier
                ctx.beginPath();
                ctx.moveTo(0, 0);
                // Waaier vorm
                ctx.arc(0, 0, 60, -0.2, 0.2); 
                ctx.closePath();
                
                // GradiÃ«nt voor fade effect
                const grad = ctx.createRadialGradient(0, 0, 10, 0, 0, 60);
                grad.addColorStop(0, `rgba(255, 255, 255, ${this.life * 0.8})`);
                grad.addColorStop(1, `rgba(255, 255, 255, 0)`);
                
                ctx.fillStyle = grad;
                ctx.fill();
                ctx.restore();
            }
        }

        class Particle {
            constructor(x, y, color) {
                this.x = x;
                this.y = y;
                this.size = Math.random() * 8 + 2; 
                const angle = Math.random() * Math.PI * 2;
                const velocity = Math.random() * 8 + 2;
                this.vx = Math.cos(angle) * velocity;
                this.vy = Math.sin(angle) * velocity;
                this.life = 1;
                this.color = color;
                this.rotation = Math.random() * Math.PI;
                this.rotSpeed = (Math.random() - 0.5) * 0.5;
            }

            update() {
                this.vx *= 0.9;
                this.vy *= 0.9;
                this.x += this.vx;
                this.y += this.vy;
                this.life -= 0.04;
                this.rotation += this.rotSpeed;
            }

            draw() {
                ctx.save();
                ctx.translate(this.x, this.y);
                ctx.rotate(this.rotation);
                ctx.globalAlpha = this.life;
                ctx.fillStyle = this.color;
                ctx.fillRect(-this.size/2, -this.size/2, this.size, this.size);
                ctx.restore();
            }
        }

        class Splat {
            constructor(x, y, color) {
                this.x = x;
                this.y = y;
                this.radius = Math.random() * 20 + 10;
                this.color = color;
                this.alpha = 0.6;
            }
            draw() {
                ctx.globalAlpha = this.alpha;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
                ctx.fillStyle = this.color;
                ctx.fill();
                ctx.globalAlpha = 1;
            }
        }

        function animate(timestamp) {
            if (!gameActive) return;

            const deltaTime = timestamp - lastTime;
            lastTime = timestamp;

            ctx.fillStyle = 'rgba(10, 10, 10, 0.4)'; 
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            bloodSplats.forEach(s => s.draw());

            const pulse = Math.sin(timestamp / 100) * 3;
            player.radius = (30 * (player.health / 100)) + pulse;
            if (player.radius < 5) player.radius = 5;

            // Speler tekenen
            ctx.beginPath();
            ctx.arc(centerX, centerY, player.radius, 0, Math.PI * 2);
            if (player.health < 30 && Math.floor(timestamp / 200) % 2 === 0) {
                ctx.fillStyle = '#ff0000'; // Alarm rood
            } else {
                ctx.fillStyle = '#eee'; // Wit/metaal
            }
            ctx.fill();
            ctx.lineWidth = 4;
            ctx.strokeStyle = '#111';
            ctx.stroke();

            // Flashes tekenen (onder de enemies, boven speler)
            muzzleFlashes.forEach((f, index) => {
                f.update();
                f.draw();
                if (f.life <= 0) muzzleFlashes.splice(index, 1);
            });

            // Tracers
            tracers.forEach((t, index) => {
                t.update();
                t.draw();
                if (t.life <= 0) tracers.splice(index, 1);
            });

            if (timestamp - lastSpawn > spawnRate) {
                enemies.push(new Enemy());
                lastSpawn = timestamp;
                if (spawnRate > 250) spawnRate -= 15; 
                difficultyMultiplier += 0.01; 
            }

            particles.forEach((p, index) => {
                p.update();
                p.draw();
                if (p.life <= 0) particles.splice(index, 1);
            });

            for (let i = enemies.length - 1; i >= 0; i--) {
                const enemy = enemies[i];
                const hitPlayer = enemy.update();
                
                if (hitPlayer) {
                    createExplosion(enemy.x, enemy.y, '#8a0303', 10);
                    enemies.splice(i, 1);
                } else {
                    enemy.draw();
                }
            }

            if (player.health <= 0) {
                endGame();
            } else {
                animationId = requestAnimationFrame(animate);
            }
        }

        // TIKKEN = SCHIETEN
        window.addEventListener('pointerdown', (e) => {
            if (!gameActive) return;

            // Maak Tracer
            tracers.push(new Tracer(e.clientX, e.clientY));
            
            // Maak Directionele Flash
            muzzleFlashes.push(new MuzzleFlash(e.clientX, e.clientY));

            let hit = false;
            for (let i = enemies.length - 1; i >= 0; i--) {
                const enemy = enemies[i];
                const dist = Math.hypot(e.clientX - enemy.x, e.clientY - enemy.y);
                
                if (dist < enemy.radius + 40) {
                    enemies.splice(i, 1);
                    const debrisColor = enemy.isElite ? '#8a0303' : '#555';
                    createExplosion(enemy.x, enemy.y, debrisColor, 15);
                    
                    if (Math.random() > 0.5) {
                        bloodSplats.push(new Splat(enemy.x, enemy.y, debrisColor === '#8a0303' ? '#4a0000' : '#222'));
                        if (bloodSplats.length > 20) bloodSplats.shift(); 
                    }

                    score += enemy.isElite ? 250 : 100;
                    scoreEl.innerText = score;
                    hit = true;
                    break; 
                }
            }
            
            if (!hit) {
                createExplosion(e.clientX, e.clientY, '#ccc', 5);
            }
        });

        function createExplosion(x, y, color, count) {
            for (let i = 0; i < count; i++) {
                particles.push(new Particle(x, y, color));
            }
        }

        function playerHit(damage) {
            player.health -= damage;
            flashOverlay.style.opacity = 0.5;
            setTimeout(() => { flashOverlay.style.opacity = 0; }, 80);
            document.body.classList.add('shaking');
            setTimeout(() => { document.body.classList.remove('shaking'); }, 400);
        }

        function startGame() {
            score = 0;
            scoreEl.innerText = '0';
            player.health = 100;
            enemies = [];
            particles = [];
            bloodSplats = [];
            tracers = [];
            muzzleFlashes = [];
            
            spawnRate = 900;
            difficultyMultiplier = 1;
            
            gameActive = true;
            startScreen.classList.add('hidden');
            gameOverScreen.classList.add('hidden');
            lastTime = performance.now();
            animate(lastTime);
        }

        function endGame() {
            gameActive = false;
            cancelAnimationFrame(animationId);
            finalScoreEl.innerText = score;
            
            const randomInsult = insults[Math.floor(Math.random() * insults.length)];
            deathMsg.innerText = randomInsult;
            
            gameOverScreen.classList.remove('hidden');
        }

        document.getElementById('startBtn').addEventListener('click', startGame);
        document.getElementById('retryBtn').addEventListener('click', startGame);

    </script>
</body>
</html>
